{"visual":{"name":"hoWengYinMatrixTable","displayName":"HoWengYinMatrixTable","guid":"hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49","visualClassName":"Visual","version":"1.0.0.0","description":"Ho Weng Yin Matrix Table 1.0","supportUrl":"www.github.com","gitHubUrl":"https://github.com/BeautifulChemistry"},"author":{"name":"Ho","email":"example@gmail.com"},"apiVersion":"5.3.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Category Data","name":"category","kind":"Grouping"},{"displayName":"Measure Data","name":"measure","kind":"Measure"}],"objects":{"dataPoint":{"properties":{"defaultColor":{"type":{"fill":{"solid":{"color":true}}}},"showAllDataPoints":{"type":{"bool":true}},"fill":{"type":{"fill":{"solid":{"color":true}}}},"fillRule":{"type":{"fill":{}}},"fontSize":{"type":{"formatting":{"fontSize":true}}}}}},"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"top":{}}},"values":{"select":[{"bind":{"to":"measure"}}]}}}],"privileges":[]},"content":{"js":"var hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49;(()=>{\"use strict\";var e={480:(e,t,a)=>{a.d(t,{S:()=>n});var i=a(674),l=i.z.Tn,s=i.z.Kx;class o extends l{defaultColor=new i.z.sk({name:\"defaultColor\",displayName:\"Default color\",value:{value:\"\"}});showAllDataPoints=new i.z.jF({name:\"showAllDataPoints\",displayName:\"Show all\",value:!0});fill=new i.z.sk({name:\"fill\",displayName:\"Fill\",value:{value:\"\"}});fillRule=new i.z.sk({name:\"fillRule\",displayName:\"Color saturation\",value:{value:\"\"}});fontSize=new i.z.iB({name:\"fontSize\",displayName:\"Text Size\",value:12});name=\"dataPoint\";displayName=\"Data colors\";slices=[this.defaultColor,this.showAllDataPoints,this.fill,this.fillRule,this.fontSize]}class n extends s{dataPointCard=new o;cards=[this.dataPointCard]}},849:(e,t,a)=>{a.d(t,{b:()=>s});var i=a(674),l=a(480);class s{target;updateCount;textNode;formattingSettings;formattingSettingsService;table;constructor(e){console.log(\"Visual constructor\",e),this.formattingSettingsService=new i.O,this.target=e.element,this.updateCount=0;const t=document.createElement(\"div\");t.style.overflowY=\"auto\",t.style.maxHeight=\"900px\",this.target.appendChild(t),this.table=document.createElement(\"table\"),this.table.style.width=\"100%\",this.table.style.borderCollapse=\"collapse\",t.appendChild(this.table)}update(e){if(this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(l.S,e.dataViews[0]),console.log(\"Visual update\",e),this.table.innerHTML=\"\",e.dataViews&&e.dataViews.length>0){const t=e.dataViews[0].categorical;if(t&&t.categories){const e=document.createElement(\"tr\");t.categories.forEach((t=>{const a=document.createElement(\"th\");a.textContent=t.source.displayName,a.style.border=\"1px solid black\",a.style.padding=\"8px\",a.style.textAlign=\"left\",\"Year\"!==t.source.displayName&&(a.style.display=\"none\"),e.appendChild(a)})),this.table.appendChild(e);const a=document.createElement(\"td\"),i=document.createElement(\"tr\");a.textContent=t.categories[0].values[0]?.toString()||\"\",a.style.border=\"1px solid black\",a.style.padding=\"8px\",i.appendChild(a),this.table.appendChild(i);const l=document.createElement(\"table\");l.style.width=\"100%\",l.style.borderCollapse=\"collapse\",l.style.display=\"block\";const s=new Set;for(let e=0;e<t.categories[1].values.length;e++){const a=t.categories[1].values[e]?.toString()||\"\";s.add(a)}s.forEach((e=>{const t=document.createElement(\"tr\"),a=document.createElement(\"td\");a.textContent=e,a.style.border=\"1px solid black\",a.style.padding=\"8px\",t.appendChild(a),t.style.cursor=\"pointer\",t.onclick=()=>{let a=t.querySelector(\".nested-table\");if(a)a.style.display=\"table\"===a.style.display?\"none\":\"table\";else{a=document.createElement(\"table\"),a.className=\"nested-table\",a.style.borderCollapse=\"collapse\",a.style.width=\"100%\",a.style.border=\"1px solid black\",a.style.display=\"block\";const i=document.createElement(\"tr\"),l=document.createElement(\"th\");l.textContent=\"Detail 1\";const s=document.createElement(\"th\");s.textContent=\"Detail 2\",l.style.border=\"1px solid black\",s.style.border=\"1px solid black\",i.appendChild(l),i.appendChild(s),a.appendChild(i);for(let t=0;t<5;t++){const i=document.createElement(\"tr\"),l=document.createElement(\"td\");l.textContent=`${e} Detail ${t+1}`;const s=document.createElement(\"td\");s.textContent=`Value ${t+1}`,l.style.border=\"1px solid black\",s.style.border=\"1px solid black\",i.appendChild(l),i.appendChild(s),a.appendChild(i)}t.appendChild(a)}},l.appendChild(t)})),l.style.display=\"none\",i.onclick=()=>{\"none\"===l.style.display?l.style.display=\"table\":l.style.display=\"none\"},this.table.appendChild(l)}}this.textNode&&(this.textNode.textContent=(this.updateCount++).toString())}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},754:(e,t,a)=>{a.d(t,{Kx:()=>o,St:()=>n,Tn:()=>r,iB:()=>u,jF:()=>d,sk:()=>p});var i=a(639);class l{}class s extends l{}class o{}class n extends l{}class r extends s{}class c extends l{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const a=this.type,i=this.name,l={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+\"-\"+i};return Object.assign(Object.assign({},l),{control:{type:a,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:i.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var a;let l=null===(a=null==e?void 0:e[t])||void 0===a?void 0:a[this.name];this.value=i.D(this,l,this.value)}}class d extends c{constructor(e){super(e),this.type=\"ToggleSwitch\"}}class p extends c{constructor(e){super(e),this.type=\"ColorPicker\"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class u extends c{constructor(e){super(e),this.type=\"NumUpDown\"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}},667:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(754);const l=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var a,l;let s=new e,o=null===(a=null==t?void 0:t.metadata)||void 0===a?void 0:a.objects;return o&&(null===(l=s.cards)||void 0===l||l.forEach((e=>{var t;e instanceof i.St&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(o,e.name)),(e instanceof i.Tn?[e]:e.groups).forEach((t=>{var a,i,l,s;null===(a=t.topLevelSlice)||void 0===a||a.setPropertiesValues(o,e.name),null===(i=null==t?void 0:t.slices)||void 0===i||i.forEach((t=>{null==t||t.setPropertiesValues(o,e.name)})),null===(s=null===(l=null==t?void 0:t.container)||void 0===l?void 0:l.containerItems)||void 0===s||s.forEach((t=>{var a;null===(a=null==t?void 0:t.slices)||void 0===a||a.forEach((t=>{null==t||t.setPropertiesValues(o,e.name)}))}))}))}))),s}buildFormattingModel(e){let t={cards:[]};return e.cards.filter((({visible:e=!0})=>e)).forEach((e=>{var a;let l={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+\"-card\",analyticsPane:e.analyticsPane};const s=e.name;if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,l.topLevelToggle=t}null===(a=e.onPreProcess)||void 0===a||a.call(e);const o=e instanceof i.Tn;(o?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((e=>{const t=e.name+\"-group\",a={displayName:o?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:o?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};l.groups.push(a);const i={};if(e.container){const l=e.container,o=t+\"-container\",n={displayName:this.localizationManager&&l.displayNameKey?this.localizationManager.getDisplayName(l.displayNameKey):l.displayName,description:this.localizationManager&&l.descriptionKey?this.localizationManager.getDisplayName(l.descriptionKey):l.description,containerItems:[],uid:o};l.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,a=o+t;let l={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:a};this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:i,formattingSlices:l.slices}),n.containerItems.push(l)})),a.container=n}if(e.slices){if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,(null==a.displayName?l:a).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:i,formattingSlices:a.slices})}})),l.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(l)})),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:a,formattingSlices:i}){null==e||e.filter((({visible:e=!0})=>e)).forEach((e=>{let l=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);l&&(void 0===a[e.name]?a[e.name]=0:(a[e.name]++,l.uid=`${l.uid}-${a[e.name]}`),i.push(l))}))}getRevertToDefaultDescriptor(e){var t;const a={};let l,s=[],o=[];return e instanceof i.St&&e.topLevelSlice&&s.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof i.Tn?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((t=>{var i,n;l=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a,t.topLevelSlice),null===(n=null===(i=t.container)||void 0===i?void 0:i.containerItems)||void 0===n||n.forEach((t=>{o=o.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a))})),s.push(...l.concat(o))})),s}getSlicesRevertToDefaultDescriptor(e,t,a,i){let l=[];return i&&(a[i.name]=!0,l=l.concat(i.getRevertToDefaultDescriptor(e))),null==t||t.forEach((t=>{t&&!a[t.name]&&(a[t.name]=!0,l=l.concat(t.getRevertToDefaultDescriptor(e)))})),l}}},674:(e,t,a)=>{a.d(t,{O:()=>l.A,z:()=>i});var i=a(754),l=a(667)},639:(e,t,a)=>{function i(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function l(e,t,a){return null==t||\"object\"==typeof t&&!t.solid?a:t.solid?{value:null==t?void 0:t.solid.color}:(null==e?void 0:e.items)?e.items.find((e=>e.value==t)):t}a.d(t,{D:()=>l,y:()=>i})}},t={};function a(i){var l=t[i];if(void 0!==l)return l.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,a),s.exports}a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};(()=>{a.r(i),a.d(i,{default:()=>s});var e=a(849),t=window.powerbi,l={name:\"hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49\",displayName:\"HoWengYinMatrixTable\",class:\"Visual\",apiVersion:\"5.3.0\",create:t=>{if(e.b)return new e.b(t);throw\"Visual instance not found\"},createModalDialog:(e,t,a)=>{const i=globalThis.dialogRegistry;e in i&&new i[e](t,a)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49=l);const s=l})(),hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49=i})();","css":"p {\n  font-size: 20px;\n  font-weight: bold;\n}\np em {\n  background: yellow;\n  padding: 5px;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":""}