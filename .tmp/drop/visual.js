var hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49;(()=>{"use strict";var e={480:(e,t,l)=>{l.d(t,{S:()=>n});var a=l(674),i=a.z.Tn,s=a.z.Kx;class o extends i{defaultColor=new a.z.sk({name:"defaultColor",displayName:"Default color",value:{value:""}});showAllDataPoints=new a.z.jF({name:"showAllDataPoints",displayName:"Show all",value:!0});fill=new a.z.sk({name:"fill",displayName:"Fill",value:{value:""}});fillRule=new a.z.sk({name:"fillRule",displayName:"Color saturation",value:{value:""}});fontSize=new a.z.iB({name:"fontSize",displayName:"Text Size",value:12});name="dataPoint";displayName="Data colors";slices=[this.defaultColor,this.showAllDataPoints,this.fill,this.fillRule,this.fontSize]}class n extends s{dataPointCard=new o;cards=[this.dataPointCard]}},849:(e,t,l)=>{l.d(t,{b:()=>s});var a=l(674),i=l(480);class s{target;updateCount;textNode;formattingSettings;formattingSettingsService;table;constructor(e){console.log("Visual constructor",e),this.formattingSettingsService=new a.O,this.target=e.element,this.updateCount=0;const t=document.createElement("div");t.style.overflowY="auto",t.style.maxHeight="900px",t.style.backgroundColor="",this.target.appendChild(t),this.table=document.createElement("table"),this.table.style.width="100%",this.table.style.borderCollapse="collapse",this.table.style.color="white",t.style.backgroundColor="transparent",t.appendChild(this.table)}getBackgroundColor(e){if(e.dataViews&&e.dataViews[0]&&e.dataViews[0].metadata.objects){const t=e.dataViews[0].metadata.objects.colorSelector;if(t&&t.backgroundColor)return t.backgroundColor.toString()}return"transparent"}update(e){this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(i.S,e.dataViews[0]),this.table.innerHTML="";const t=this.getBackgroundColor(e);if(this.table.style.backgroundColor=t,e.dataViews&&e.dataViews.length>0){const t=e.dataViews[0].categorical;if(t&&t.categories){const e=document.createElement("tr");t.categories.forEach((t=>{const l=document.createElement("th");l.textContent=t.source.displayName,l.style.border="1px solid white",l.style.textAlign="left",t.source.displayName,l.style.display="none",e.appendChild(l)})),this.table.appendChild(e);const l=document.createElement("tr");["Year","HC as today","Resign Employee","Balance HC"].forEach((e=>{const t=document.createElement("th");t.textContent=e,t.style.border="1px solid white",l.appendChild(t)})),this.table.appendChild(l);const a=document.createElement("tr"),i=document.createElement("td");i.textContent=t.categories[0].values[0]?.toString()||"",i.style.border="1px solid white",a.appendChild(i);const s=document.createElement("td");s.textContent="Second Cell Content",s.style.border="1px solid white",a.appendChild(s);const o=document.createElement("td");o.textContent="Third Cell Content",o.style.border="1px solid white",a.appendChild(o);const n=document.createElement("td");n.textContent="Third Cell Content",n.style.border="1px solid white",a.appendChild(n),this.table.appendChild(a);const r=document.createElement("table");r.style.width="100%",r.style.borderCollapse="collapse",r.style.display="block";const c=new Set;for(let e=0;e<t.categories[1].values.length;e++){const l=t.categories[1].values[e]?.toString()||"";c.add(l)}c.forEach((e=>{const l=document.createElement("tr"),a=document.createElement("td");a.textContent=e,a.style.border="1px solid white",a.style.padding="8px",l.appendChild(a),l.style.cursor="pointer",l.onclick=()=>{const e=l.textContent?.trim();let a=l.querySelector(".nested-table");if(a)a.style.backgroundColor="",a.style.display="table"===a.style.display?"none":"table";else{a=document.createElement("table"),a.className="nested-table",a.style.borderCollapse="collapse",a.style.width="100%",a.style.border="1px solid white",a.style.display="block";for(let l=0;l<t.categories[1].values.length;l++){const i=t.categories[1].values[l]?.toString(),s=t.categories[2].values[l]?.toString();if(i===e){const o=document.createElement("tr"),n=document.createElement("td");n.textContent=` ${l+1}`,n.style.border="1px solid white",n.style.backgroundColor="",o.appendChild(n),a.appendChild(o);const r=document.createElement("tr"),c=document.createElement("td");c.textContent=` ${i} and ${s}`;for(let l=0;l<t.categories[1].values.length;l++){const a=t.categories[1].values[l]?.toString();for(let i=0;i<t.categories[2].values.length;i++){const s=t.categories[2].values[i]?.toString();a===e&&s==s&&(c.textContent=t.categories[3].values[l].toString(),c.style.border="1px solid white",r.style.display="none",r.appendChild(c))}}a.appendChild(r),a.style.backgroundColor="",o.onclick=()=>{r.style.display="none"===r.style.display?"table-row":"none"}}}l.appendChild(a)}},r.appendChild(l)}));const d=document.createElement("td"),p=document.createElement("tr");d.appendChild(r),d.style.border="1px solid white",d.style.padding="8px",p.appendChild(d);const u=document.createElement("td");u.textContent="Second Cell Content",u.style.border="1px solid white",u.style.padding="8px",p.appendChild(u);const m=document.createElement("td");m.textContent="Third Cell Content",m.style.border="1px solid white",m.style.padding="8px",p.appendChild(m);const g=document.createElement("td");g.textContent="Fourth Cell Content",g.style.border="1px solid white",g.style.padding="8px",p.appendChild(g),this.table.appendChild(p),r.style.display="none",d.style.display="none",u.style.display="none",m.style.display="none",a.onclick=()=>{"none"===r.style.display?(r.style.display="table",u.style.display="table-cell",m.style.display="table-cell"):(r.style.display="none",u.style.display="none",m.style.display="none")}}}}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},754:(e,t,l)=>{l.d(t,{Kx:()=>o,St:()=>n,Tn:()=>r,iB:()=>u,jF:()=>d,sk:()=>p});var a=l(639);class i{}class s extends i{}class o{}class n extends i{}class r extends s{}class c extends i{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const l=this.type,a=this.name,i={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+a};return Object.assign(Object.assign({},i),{control:{type:l,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:a.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var l;let i=null===(l=null==e?void 0:e[t])||void 0===l?void 0:l[this.name];this.value=a.D(this,i,this.value)}}class d extends c{constructor(e){super(e),this.type="ToggleSwitch"}}class p extends c{constructor(e){super(e),this.type="ColorPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class u extends c{constructor(e){super(e),this.type="NumUpDown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}},667:(e,t,l)=>{l.d(t,{A:()=>i});var a=l(754);const i=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var l,i;let s=new e,o=null===(l=null==t?void 0:t.metadata)||void 0===l?void 0:l.objects;return o&&(null===(i=s.cards)||void 0===i||i.forEach((e=>{var t;e instanceof a.St&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(o,e.name)),(e instanceof a.Tn?[e]:e.groups).forEach((t=>{var l,a,i,s;null===(l=t.topLevelSlice)||void 0===l||l.setPropertiesValues(o,e.name),null===(a=null==t?void 0:t.slices)||void 0===a||a.forEach((t=>{null==t||t.setPropertiesValues(o,e.name)})),null===(s=null===(i=null==t?void 0:t.container)||void 0===i?void 0:i.containerItems)||void 0===s||s.forEach((t=>{var l;null===(l=null==t?void 0:t.slices)||void 0===l||l.forEach((t=>{null==t||t.setPropertiesValues(o,e.name)}))}))}))}))),s}buildFormattingModel(e){let t={cards:[]};return e.cards.filter((({visible:e=!0})=>e)).forEach((e=>{var l;let i={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+"-card",analyticsPane:e.analyticsPane};const s=e.name;if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,i.topLevelToggle=t}null===(l=e.onPreProcess)||void 0===l||l.call(e);const o=e instanceof a.Tn;(o?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((e=>{const t=e.name+"-group",l={displayName:o?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:o?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};i.groups.push(l);const a={};if(e.container){const i=e.container,o=t+"-container",n={displayName:this.localizationManager&&i.displayNameKey?this.localizationManager.getDisplayName(i.displayNameKey):i.displayName,description:this.localizationManager&&i.descriptionKey?this.localizationManager.getDisplayName(i.descriptionKey):i.description,containerItems:[],uid:o};i.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,l=o+t;let i={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:l};this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:a,formattingSlices:i.slices}),n.containerItems.push(i)})),l.container=n}if(e.slices){if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,(null==l.displayName?i:l).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:a,formattingSlices:l.slices})}})),i.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(i)})),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:l,formattingSlices:a}){null==e||e.filter((({visible:e=!0})=>e)).forEach((e=>{let i=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);i&&(void 0===l[e.name]?l[e.name]=0:(l[e.name]++,i.uid=`${i.uid}-${l[e.name]}`),a.push(i))}))}getRevertToDefaultDescriptor(e){var t;const l={};let i,s=[],o=[];return e instanceof a.St&&e.topLevelSlice&&s.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof a.Tn?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((t=>{var a,n;i=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,l,t.topLevelSlice),null===(n=null===(a=t.container)||void 0===a?void 0:a.containerItems)||void 0===n||n.forEach((t=>{o=o.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,l))})),s.push(...i.concat(o))})),s}getSlicesRevertToDefaultDescriptor(e,t,l,a){let i=[];return a&&(l[a.name]=!0,i=i.concat(a.getRevertToDefaultDescriptor(e))),null==t||t.forEach((t=>{t&&!l[t.name]&&(l[t.name]=!0,i=i.concat(t.getRevertToDefaultDescriptor(e)))})),i}}},674:(e,t,l)=>{l.d(t,{O:()=>i.A,z:()=>a});var a=l(754),i=l(667)},639:(e,t,l)=>{function a(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function i(e,t,l){return null==t||"object"==typeof t&&!t.solid?l:t.solid?{value:null==t?void 0:t.solid.color}:(null==e?void 0:e.items)?e.items.find((e=>e.value==t)):t}l.d(t,{D:()=>i,y:()=>a})}},t={};function l(a){var i=t[a];if(void 0!==i)return i.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,l),s.exports}l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{l.r(a),l.d(a,{default:()=>s});var e=l(849),t=window.powerbi,i={name:"hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49",displayName:"HoWengYinMatrixTable",class:"Visual",apiVersion:"5.3.0",create:t=>{if(e.b)return new e.b(t);throw"Visual instance not found"},createModalDialog:(e,t,l)=>{const a=globalThis.dialogRegistry;e in a&&new a[e](t,l)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49=i);const s=i})(),hoWengYinMatrixTableE838FCB52C814B73BA60BDEF8BB87D49=a})();